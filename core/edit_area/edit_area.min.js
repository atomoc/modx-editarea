function EditArea(){var c=this;c.error=false;c.inlinePopup=[{popup_id:"area_search_replace",icon_id:"search"},{popup_id:"edit_area_help",icon_id:"help"}];
c.plugins={};c.line_number=0;parent.editAreaLoader.set_browser_infos(c);if(c.isIE>=8){c.isIE=7;}c.last_selection={};c.last_text_to_highlight="";c.last_hightlighted_text="";
c.syntax_list=[];c.allready_used_syntax={};c.check_line_selection_timer=50;c.textareaFocused=false;c.highlight_selection_line=null;c.previous=[];c.next=[];
c.last_undo="";c.files={};c.filesIdAssoc={};c.curr_file="";c.assocBracket={};c.revertAssocBracket={};c.assocBracket["("]=")";c.assocBracket["{"]="}";c.assocBracket["["]="]";
for(var a in c.assocBracket){c.revertAssocBracket[c.assocBracket[a]]=a;}c.is_editable=true;c.docid=s.docid;c.lineHeight=16;c.tab_nb_char=8;if(c.isOpera){c.tab_nb_char=6;
}c.is_tabbing=false;c.fullscreen={isFull:false};c.isResizing=false;c.id=area_id;c.settings=editAreas[c.id]["settings"];if((""+c.settings.replace_tab_by_spaces).match(/^[0-9]+$/)){c.tab_nb_char=c.settings.replace_tab_by_spaces;
c.tabulation="";for(var b=0;b<c.tab_nb_char;b++){c.tabulation+=" ";}}else{c.tabulation="\t";}if(c.settings.syntax_selection_allow&&c.settings.syntax_selection_allow.length>0){c.syntax_list=c.settings.syntax_selection_allow.replace(/ /g,"").split(",");
}if(c.settings.syntax){c.allready_used_syntax[c.settings.syntax]=true;}}EditArea.prototype.init=function(){var k=this,h,l=k.settings;k.textarea=_$("textarea");
k.container=_$("container");k.result=_$("result");k.content_highlight=_$("content_highlight");k.selection_field=_$("selection_field");k.selection_field_text=_$("selection_field_text");
k.processing_screen=_$("processing");k.editor_area=_$("editor");k.tab_browsing_area=_$("tab_browsing_area");k.test_font_size=_$("test_font_size");h=k.textarea;
if(!l.is_editable){k.set_editable(false);}k.set_show_line_colors(l.show_line_colors);if(syntax_selec=_$("syntax_selection")){for(var f=0;f<k.syntax_list.length;
f++){var d=k.syntax_list[f];var g=document.createElement("option");g.value=d;if(d==l.syntax){g.selected="selected";}dispSyntax=parent.editAreaLoader.syntax_display_name[d];
g.innerHTML=typeof(dispSyntax)=="undefined"?d.substring(0,1).toUpperCase()+d.substring(1):dispSyntax;syntax_selec.appendChild(g);}}spans=parent.getChildren(_$("toolbar_1"),"span","","","all",-1);
for(var f=0;f<spans.length;f++){id=spans[f].id.replace(/tmp_tool_(.*)/,"$1");if(id!=spans[f].id){for(var e in k.plugins){if(typeof(k.plugins[e].get_control_html)=="function"){html=k.plugins[e].get_control_html(id);
if(html!=false){html=k.get_translation(html,"template");var b=document.createElement("span");b.innerHTML=html;var c=spans[f].parentNode;spans[f].parentNode.replaceChild(b,spans[f]);
break;}}}}}if(l.debug){k.debug=parent.document.getElementById("edit_area_debug_"+k.id);}if(_$("redo")!=null){k.switchClassSticky(_$("redo"),"editAreaButtonDisabled",true);
}if(typeof(parent.editAreaLoader.syntax[l.syntax])!="undefined"){for(var f in parent.editAreaLoader.syntax){if(typeof(parent.editAreaLoader.syntax[f]["styles"])!="undefined"){k.add_style(parent.editAreaLoader.syntax[f]["styles"]);
}}}if(k.isOpera){_$("editor").onkeypress=keyDown;}else{_$("editor").onkeydown=keyDown;}for(var f=0;f<k.inlinePopup.length;f++){if(k.isOpera){_$(k.inlinePopup[f]["popup_id"]).onkeypress=keyDown;
}else{_$(k.inlinePopup[f]["popup_id"]).onkeydown=keyDown;}}if(l.allow_resize=="both"||l.allow_resize=="x"||l.allow_resize=="y"){k.allow_resize(true);}parent.editAreaLoader.toggle(k.id,"on");
k.change_smooth_selection_mode(editArea.smooth_selection);k.execCommand("change_highlight",l.start_highlight);k.set_font(editArea.settings.font_family,editArea.settings.font_size);
children=parent.getChildren(document.body,"","selec","none","all",-1);for(var f=0;f<children.length;f++){if(k.isIE){children[f].unselectable=true;}else{children[f].onmousedown=function(){return false;
};}}h.spellcheck=l.gecko_spellcheck;if(k.isFirefox>="3"){k.content_highlight.style.paddingLeft="1px";k.selection_field.style.paddingLeft="1px";k.selection_field_text.style.paddingLeft="1px";
}if(k.isIE&&k.isIE<8){h.style.marginTop="-1px";}if(k.isSafari){k.editor_area.style.position="absolute";h.style.marginLeft="-3px";if(k.isSafari<3.2){h.style.marginTop="1px";
}}parent.editAreaLoader.add_event(k.result,"click",function(a){if((a.target||a.srcElement)==editArea.result){editArea.area_select(editArea.textarea.value.length,0);
}});if(l.is_multi_files!=false){k.open_file({id:k.curr_file,text:""});}k.set_word_wrap(l.word_wrap);setTimeout("editArea.focus();editArea.manage_size();editArea.execCommand('EA_load');",10);
k.check_undo();k.check_line_selection(true);k.scroll_to_view();for(var f in k.plugins){if(typeof(k.plugins[f].onload)=="function"){k.plugins[f].onload();
}}if(sessionStorage.editarea_fullscreen&&l.fullscreen==true){k.toggle_full_screen(true);}parent.editAreaLoader.add_event(window,"resize",editArea.update_size);
parent.editAreaLoader.add_event(parent.window,"resize",editArea.update_size);parent.editAreaLoader.add_event(top.window,"resize",editArea.update_size);
parent.editAreaLoader.add_event(window,"unload",function(){if(parent.editAreaLoader){parent.editAreaLoader.remove_event(parent.window,"resize",editArea.update_size);
parent.editAreaLoader.remove_event(top.window,"resize",editArea.update_size);}if(editAreas[editArea.id]&&editAreas[editArea.id]["displayed"]){editArea.execCommand("EA_unload");
}});};EditArea.prototype.update_size=function(){var h=document,c=parent.document,a,f,b,e,g;if(typeof editAreas!="undefined"&&editAreas[editArea.id]&&editAreas[editArea.id]["displayed"]==true){if(editArea.fullscreen.isFull){c.getElementById("frame_"+editArea.id).style.width=c.getElementsByTagName("html")[0].clientWidth+"px";
c.getElementById("frame_"+editArea.id).style.height=c.getElementsByTagName("html")[0].clientHeight+"px";}if(editArea.tab_browsing_area.style.display=="block"&&(!editArea.isIE||editArea.isIE>=8)){editArea.tab_browsing_area.style.height="0px";
editArea.tab_browsing_area.style.height=(editArea.result.offsetTop-editArea.tab_browsing_area.offsetTop-1)+"px";}a=h.body.offsetHeight-editArea.get_all_toolbar_height()-4;
editArea.result.style.height=a+"px";f=h.body.offsetWidth-2;editArea.result.style.width=f+"px";for(i=0;i<editArea.inlinePopup.length;i++){b=_$(editArea.inlinePopup[i]["popup_id"]);
e=h.body.offsetWidth-b.offsetWidth;g=h.body.offsetHeight-b.offsetHeight;if(b.offsetTop>g){b.style.top=g+"px";}if(b.offsetLeft>e){b.style.left=e+"px";}}editArea.manage_size(true);
editArea.fixLinesHeight(editArea.textarea.value,0,-1);}};EditArea.prototype.manage_size=function(h){if(!editAreas[this.id]){return false;}if(editAreas[this.id]["displayed"]==true&&this.textareaFocused){var f,c=false;
if(!this.settings.word_wrap){var e=this.textarea.scrollWidth;f=this.textarea.scrollHeight;if(this.isOpera&&this.isOpera<9.6){e=10000;}if(this.textarea.previous_scrollWidth!=e){this.container.style.width=e+"px";
this.textarea.style.width=e+"px";this.content_highlight.style.width=e+"px";this.textarea.previous_scrollWidth=e;c=true;}}if(this.settings.word_wrap){newW=this.textarea.offsetWidth;
if(this.isFirefox||this.isIE){newW-=2;}if(this.isSafari){newW-=6;}this.content_highlight.style.width=this.selection_field_text.style.width=this.selection_field.style.width=this.test_font_size.style.width=newW+"px";
}if(this.isOpera||this.isFirefox||this.isSafari){f=this.getLinePosTop(this.last_selection.nb_line+1);}else{f=this.textarea.scrollHeight;}if(this.textarea.previous_scrollHeight!=f){this.container.style.height=(f+2)+"px";
this.textarea.style.height=f+"px";this.content_highlight.style.height=f+"px";this.textarea.previous_scrollHeight=f;c=true;}if(this.last_selection.nb_line>=this.line_number){var b="",d=_$("line_number"),g=this.line_number,a=this.last_selection.nb_line+100;
for(i=g+1;i<a;i++){b+='<div id="line_'+i+'">'+i+"</div>";this.line_number++;}d.innerHTML=d.innerHTML+b;if(this.settings.word_wrap){this.fixLinesHeight(this.textarea.value,g,-1);
}}this.textarea.scrollTop="0px";this.textarea.scrollLeft="0px";if(c==true){this.scroll_to_view();}}if(!h){setTimeout("editArea.manage_size();",100);}};
EditArea.prototype.execCommand=function(cmd,param){for(var i in this.plugins){if(typeof(this.plugins[i].execCommand)=="function"){if(!this.plugins[i].execCommand(cmd,param)){return;
}}}switch(cmd){case"save":if(this.settings.save_callback.length>0){eval("parent."+this.settings.save_callback+"('"+this.id+"', editArea.textarea.value);");
}break;case"load":if(this.settings.load_callback.length>0){eval("parent."+this.settings.load_callback+"('"+this.id+"');");}break;case"onchange":if(this.settings.change_callback.length>0){eval("parent."+this.settings.change_callback+"('"+this.id+"');");
}break;case"EA_load":if(this.settings.EA_load_callback.length>0){eval("parent."+this.settings.EA_load_callback+"('"+this.id+"');");}break;case"EA_unload":if(this.settings.EA_unload_callback.length>0){eval("parent."+this.settings.EA_unload_callback+"('"+this.id+"');");
}break;case"toggle_on":if(this.settings.EA_toggle_on_callback.length>0){eval("parent."+this.settings.EA_toggle_on_callback+"('"+this.id+"');");}break;case"toggle_off":if(this.settings.EA_toggle_off_callback.length>0){eval("parent."+this.settings.EA_toggle_off_callback+"('"+this.id+"');");
}break;case"re_sync":if(!this.do_highlight){break;}case"file_switch_on":if(this.settings.EA_file_switch_on_callback.length>0){eval("parent."+this.settings.EA_file_switch_on_callback+"(param);");
}break;case"file_switch_off":if(this.settings.EA_file_switch_off_callback.length>0){eval("parent."+this.settings.EA_file_switch_off_callback+"(param);");
}break;case"file_close":if(this.settings.EA_file_close_callback.length>0){return eval("parent."+this.settings.EA_file_close_callback+"(param);");}break;
default:if(typeof(eval("editArea."+cmd))=="function"){if(this.settings.debug){eval("editArea."+cmd+"(param);");}else{try{eval("editArea."+cmd+"(param);");
}catch(e){}}}}};EditArea.prototype.get_translation=function(a,b){if(b=="template"){return parent.editAreaLoader.translate(a,this.settings.language,b);}else{return parent.editAreaLoader.get_word_translation(a,this.settings.language);
}};EditArea.prototype.add_plugin=function(b,c){for(var a=0;a<this.settings.plugins.length;a++){if(this.settings.plugins[a]==b){this.plugins[b]=c;c.baseURL=parent.editAreaLoader.baseURL+"plugins/"+b+"/";
if(typeof(c.init)=="function"){c.init();}}}};EditArea.prototype.load_css=function(a){try{link=document.createElement("link");link.type="text/css";link.rel="stylesheet";
link.media="all";link.href=a;head=document.getElementsByTagName("head");head[0].appendChild(link);}catch(b){document.write("<link href='"+a+"' rel='stylesheet' type='text/css' />");
}};EditArea.prototype.load_script=function(a){try{script=document.createElement("script");script.type="text/javascript";script.src=a;script.charset="UTF-8";
head=document.getElementsByTagName("head");head[0].appendChild(script);}catch(b){document.write("<script type='text/javascript' src='"+a+'\' charset="UTF-8"><\/script>');
}};EditArea.prototype.add_lang=function(c,a){if(!parent.editAreaLoader.lang[c]){parent.editAreaLoader.lang[c]={};}for(var b in a){parent.editAreaLoader.lang[c][b]=a[b];
}};function _$(a){return document.getElementById(a);}var editArea=new EditArea();parent.editAreaLoader.add_event(window,"load",init);function init(){setTimeout("editArea.init();  ",10);
}